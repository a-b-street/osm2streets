import{S as M,i as P,s as T,c as Y,e as g,a as O,b as d,u as x,g as ee,d as te,t as b,f as k,h as $,L as F,j as H,k as q,l as U,m as v,n as y,o as L,p as K,q as C,r as S,v as Q,w as D,x as ne,y as E,z as w,A as G,B as I,C as V,D as W,E as J,F as Z,G as X,H as se,I as re,J as oe,K as le,M as ie,N as ae,O as fe,P as pe,Q as ue,R as ce,T as me,_ as de,U as $e,V as _e}from"./MainLayers-bb5e4bd8.js";function ge(l){let e,r;const t=l[1].default,s=Y(t,l,l[0],null);return{c(){e=g("div"),s&&s.c(),O(e,"class","svelte-eycl9h")},m(o,a){d(o,e,a),s&&s.m(e,null),r=!0},p(o,[a]){s&&s.p&&(!r||a&1)&&x(s,t,o,o[0],r?te(t,o[0],a,null):ee(o[0]),null)},i(o){r||(b(s,o),r=!0)},o(o){k(s,o),r=!1},d(o){o&&$(e),s&&s.d(o)}}}function we(l,e,r){let{$$slots:t={},$$scope:s}=e;return l.$$set=o=>{"$$scope"in o&&r(0,s=o.$$scope)},[s,t]}class he extends M{constructor(e){super(),P(this,e,we,ge,T,{})}}function ye(l){let e,r,t,s,o;e=new F({props:{source:"connected-roads",gj:l[0],layerStyle:l[2],show:l[1]}});function a(i){l[5](i)}let n={gj:l[0],name:"Roads connected to intersection",downloadable:!1};return l[1]!==void 0&&(n.show=l[1]),t=new H({props:n}),q.push(()=>U(t,"show",a)),{c(){v(e.$$.fragment),r=y(),v(t.$$.fragment)},m(i,f){L(e,i,f),d(i,r,f),L(t,i,f),o=!0},p(i,[f]){const m={};f&1&&(m.gj=i[0]),f&2&&(m.show=i[1]),e.$set(m);const c={};f&1&&(c.gj=i[0]),!s&&f&2&&(s=!0,c.show=i[1],K(()=>s=!1)),t.$set(c)},i(i){o||(b(e.$$.fragment,i),b(t.$$.fragment,i),o=!0)},o(i){k(e.$$.fragment,i),k(t.$$.fragment,i),o=!1},d(i){i&&$(r),C(e,i),C(t,i)}}}function be(l,e,r){let t,s;S(l,Q,f=>r(3,t=f)),S(l,D,f=>r(4,s=f));let o,a=!0,n={type:"fill",paint:{"fill-color":"blue","fill-opacity":.5}};function i(f){a=f,r(1,a)}return l.$$.update=()=>{l.$$.dirty&24&&(s&&t?r(0,o=JSON.parse(s.debugRoadsConnectedToIntersectionGeojson(t.properties.id))):r(0,o=void 0))},[o,a,n,t,s,i]}class ke extends M{constructor(e){super(),P(this,e,be,ye,T,{})}}function ve(l){let e,r,t,s,o;e=new F({props:{source:"movements",gj:l[0],layerStyle:l[2],show:l[1]}});function a(i){l[5](i)}let n={gj:l[0],name:"Movement arrows",downloadable:!1};return l[1]!==void 0&&(n.show=l[1]),t=new H({props:n}),q.push(()=>U(t,"show",a)),{c(){v(e.$$.fragment),r=y(),v(t.$$.fragment)},m(i,f){L(e,i,f),d(i,r,f),L(t,i,f),o=!0},p(i,[f]){const m={};f&1&&(m.gj=i[0]),f&2&&(m.show=i[1]),e.$set(m);const c={};f&1&&(c.gj=i[0]),!s&&f&2&&(s=!0,c.show=i[1],K(()=>s=!1)),t.$set(c)},i(i){o||(b(e.$$.fragment,i),b(t.$$.fragment,i),o=!0)},o(i){k(e.$$.fragment,i),k(t.$$.fragment,i),o=!1},d(i){i&&$(r),C(e,i),C(t,i)}}}function Le(l,e,r){let t,s;S(l,D,f=>r(3,t=f)),S(l,ne,f=>r(4,s=f));let o,a=!0,n={type:"fill",paint:{"fill-color":"blue","fill-opacity":.5}};function i(f){a=f,r(1,a)}return l.$$.update=()=>{if(l.$$.dirty&24)if(t&&s){let f=s.properties;r(0,o=JSON.parse(t.debugMovementsFromLaneGeojson(f.road,f.index)))}else r(0,o=void 0)},[o,a,n,t,s,i]}class Ce extends M{constructor(e){super(),P(this,e,Le,ve,T,{})}}function Se(l){let e,r,t,s,o,a;return{c(){e=g("div"),r=g("label"),t=g("input"),s=E(`
    Clockwise ordering of roads`),O(t,"type","checkbox")},m(n,i){d(n,e,i),w(e,r),w(r,t),t.checked=l[0],w(r,s),o||(a=G(t,"change",l[5]),o=!0)},p(n,[i]){i&1&&(t.checked=n[0])},i:I,o:I,d(n){n&&$(e),o=!1,a()}}}function Oe(l,e,r){let t,s,o;S(l,V,f=>r(2,t=f)),S(l,Q,f=>r(3,s=f)),S(l,D,f=>r(4,o=f));let a=[],n=!1;function i(){n=this.checked,r(0,n)}return l.$$.update=()=>{if(l.$$.dirty&31){for(let f of a)f.remove();if(r(1,a=[]),n&&s){let f=JSON.parse(o.debugClockwiseOrderingForIntersectionGeojson(s.properties.id));for(let m of f.features)a.push(new W.Popup({closeButton:!1,closeOnClick:!1,focusAfterOpen:!1}).setLngLat(m.geometry.coordinates).setHTML(m.properties.label).addTo(t))}}},[n,a,t,s,o,i]}class je extends M{constructor(e){super(),P(this,e,Oe,Se,T,{})}}function Ie(l){let e,r,t,s,o,a;return e=new Ce({}),t=new je({}),o=new ke({}),{c(){v(e.$$.fragment),r=y(),v(t.$$.fragment),s=y(),v(o.$$.fragment)},m(n,i){L(e,n,i),d(n,r,i),L(t,n,i),d(n,s,i),L(o,n,i),a=!0},p:I,i(n){a||(b(e.$$.fragment,n),b(t.$$.fragment,n),b(o.$$.fragment,n),a=!0)},o(n){k(e.$$.fragment,n),k(t.$$.fragment,n),k(o.$$.fragment,n),a=!1},d(n){n&&($(r),$(s)),C(e,n),C(t,n),C(o,n)}}}class Me extends M{constructor(e){super(),P(this,e,null,Ie,T,{})}}function R(l,e,r){const t=l.slice();return t[4]=e[r],t}function A(l){let e,r=l[4]+"",t,s,o;return{c(){e=g("a"),t=E(r),o=E(","),O(e,"href",s="https://www.openstreetmap.org/node/"+l[4]),O(e,"target","_blank")},m(a,n){d(a,e,n),w(e,t),d(a,o,n)},p(a,n){n&1&&r!==(r=a[4]+"")&&X(t,r),n&1&&s!==(s="https://www.openstreetmap.org/node/"+a[4])&&O(e,"href",s)},d(a){a&&($(e),$(o))}}}function Pe(l){let e,r,t,s,o,a,n,i,f,m=J(l[0].properties.osm_node_ids),c=[];for(let u=0;u<m.length;u+=1)c[u]=A(R(l,m,u));return{c(){e=g("pre"),e.textContent=`${JSON.stringify(l[1],null,"  ")}`,r=y(),t=g("div"),s=E(`OSM nodes:
  `);for(let u=0;u<c.length;u+=1)c[u].c();o=y(),a=g("div"),n=g("button"),n.textContent="Collapse intersection",O(n,"type","button")},m(u,_){d(u,e,_),d(u,r,_),d(u,t,_),w(t,s);for(let p=0;p<c.length;p+=1)c[p]&&c[p].m(t,null);d(u,o,_),d(u,a,_),w(a,n),i||(f=G(n,"click",l[2]),i=!0)},p(u,[_]){if(_&1){m=J(u[0].properties.osm_node_ids);let p;for(p=0;p<m.length;p+=1){const j=R(u,m,p);c[p]?c[p].p(j,_):(c[p]=A(j),c[p].c(),c[p].m(t,null))}for(;p<c.length;p+=1)c[p].d(1);c.length=m.length}},i:I,o:I,d(u){u&&($(e),$(r),$(t),$(o),$(a)),Z(c,u),i=!1,f()}}}function Te(l,e,r){let t;S(l,D,n=>r(3,t=n));let{intersection:s}=e,o=structuredClone(s.properties);delete o.osm_node_ids;function a(){t.collapseIntersection(s.properties.id),D.set(t)}return l.$$set=n=>{"intersection"in n&&r(0,s=n.intersection)},[s,o,a]}class De extends M{constructor(e){super(),P(this,e,Te,Pe,T,{intersection:0})}}function B(l,e,r){const t=l.slice();return t[5]=e[r],t}function z(l){let e,r=l[5]+"",t,s,o;return{c(){e=g("a"),t=E(r),o=E(","),O(e,"href",s="https://www.openstreetmap.org/way/"+l[5]),O(e,"target","_blank")},m(a,n){d(a,e,n),w(e,t),d(a,o,n)},p(a,n){n&1&&r!==(r=a[5]+"")&&X(t,r),n&1&&s!==(s="https://www.openstreetmap.org/way/"+a[5])&&O(e,"href",s)},d(a){a&&($(e),$(o))}}}function Ee(l){let e,r,t,s,o,a,n,i,f,m,c,u=J(l[0].properties.osm_way_ids),_=[];for(let p=0;p<u.length;p+=1)_[p]=z(B(l,u,p));return{c(){e=g("pre"),e.textContent=`${JSON.stringify(l[1],null,"  ")}`,r=y(),t=g("div"),s=E(`OSM ways:
  `);for(let p=0;p<_.length;p+=1)_[p].c();o=y(),a=g("div"),n=g("button"),n.textContent="Collapse short road",i=y(),f=g("button"),f.textContent="Zip side-path",O(n,"type","button"),O(f,"type","button")},m(p,j){d(p,e,j),d(p,r,j),d(p,t,j),w(t,s);for(let h=0;h<_.length;h+=1)_[h]&&_[h].m(t,null);d(p,o,j),d(p,a,j),w(a,n),w(a,i),w(a,f),m||(c=[G(n,"click",l[2]),G(f,"click",l[3])],m=!0)},p(p,[j]){if(j&1){u=J(p[0].properties.osm_way_ids);let h;for(h=0;h<u.length;h+=1){const N=B(p,u,h);_[h]?_[h].p(N,j):(_[h]=z(N),_[h].c(),_[h].m(t,null))}for(;h<_.length;h+=1)_[h].d(1);_.length=u.length}},i:I,o:I,d(p){p&&($(e),$(r),$(t),$(o),$(a)),Z(_,p),m=!1,se(c)}}}function Ge(l,e,r){let t;S(l,D,i=>r(4,t=i));let{lane:s}=e,o=structuredClone(s.properties);delete o.osm_way_ids;function a(){t.collapseShortRoad(s.properties.road),D.set(t)}function n(){t.zipSidepath(s.properties.road),D.set(t)}return l.$$set=i=>{"lane"in i&&r(0,s=i.lane)},[s,o,a,n]}class Je extends M{constructor(e){super(),P(this,e,Ge,Ee,T,{lane:0})}}function Ne(l,e,r){let t,s,o,a,n;S(l,V,f=>r(0,t=f)),S(l,oe,f=>r(1,s=f)),S(l,le,f=>r(2,o=f)),S(l,ie,f=>r(3,a=f)),S(l,ae,f=>r(4,n=f));let i=new W.Popup({closeButton:!1,closeOnClick:!1,maxWidth:"none"});return re(()=>{i.remove()}),l.$$.update=()=>{if(l.$$.dirty&31)if(n){let f=document.createElement("div");new Je({target:f,props:{lane:n}}),i.setLngLat(a).setDOMContent(f).addTo(t)}else if(o){let f=document.createElement("div");new De({target:f,props:{intersection:o}}),i.setLngLat(s).setDOMContent(f).addTo(t)}else i.remove()},[t,s,o,a,n]}class Re extends M{constructor(e){super(),P(this,e,Ne,null,T,{})}}function Ae(l){let e,r,t,s,o,a,n,i,f,m,c;return s=new ue({}),m=new ce({}),{c(){e=g("div"),r=g("h1"),r.textContent="osm2streets Street Explorer",t=y(),v(s.$$.fragment),o=y(),a=g("p"),a.innerHTML=`Understanding OSM streets &amp; intersections with
      <a href="https://github.com/a-b-street/osm2streets" target="_blank">osm2streets</a>.`,n=y(),i=g("hr"),f=y(),v(m.$$.fragment),O(e,"slot","left")},m(u,_){d(u,e,_),w(e,r),w(e,t),L(s,e,null),w(e,o),w(e,a),w(e,n),w(e,i),w(e,f),L(m,e,null),c=!0},p:I,i(u){c||(b(s.$$.fragment,u),b(m.$$.fragment,u),c=!0)},o(u){k(s.$$.fragment,u),k(m.$$.fragment,u),c=!1},d(u){u&&$(e),C(s),C(m)}}}function Be(l){let e,r,t,s,o,a;return e=new _e({}),o=new Me({}),{c(){v(e.$$.fragment),r=y(),t=g("hr"),s=y(),v(o.$$.fragment)},m(n,i){L(e,n,i),d(n,r,i),d(n,t,i),d(n,s,i),L(o,n,i),a=!0},p:I,i(n){a||(b(e.$$.fragment,n),b(o.$$.fragment,n),a=!0)},o(n){k(e.$$.fragment,n),k(o.$$.fragment,n),a=!1},d(n){n&&($(r),$(t),$(s)),C(e,n),C(o,n)}}}function ze(l){let e,r,t,s,o,a;return e=new he({props:{$$slots:{default:[Be]},$$scope:{ctx:l}}}),t=new Re({}),o=new $e({}),{c(){v(e.$$.fragment),r=y(),v(t.$$.fragment),s=y(),v(o.$$.fragment)},m(n,i){L(e,n,i),d(n,r,i),L(t,n,i),d(n,s,i),L(o,n,i),a=!0},p(n,i){const f={};i&1&&(f.$$scope={dirty:i,ctx:n}),e.$set(f)},i(n){a||(b(e.$$.fragment,n),b(t.$$.fragment,n),b(o.$$.fragment,n),a=!0)},o(n){k(e.$$.fragment,n),k(t.$$.fragment,n),k(o.$$.fragment,n),a=!1},d(n){n&&($(r),$(s)),C(e,n),C(t,n),C(o,n)}}}function Fe(l){let e,r,t;return r=new me({props:{$$slots:{default:[ze]},$$scope:{ctx:l}}}),{c(){e=g("div"),v(r.$$.fragment),O(e,"slot","main")},m(s,o){d(s,e,o),L(r,e,null),t=!0},p(s,o){const a={};o&1&&(a.$$scope={dirty:o,ctx:s}),r.$set(a)},i(s){t||(b(r.$$.fragment,s),t=!0)},o(s){k(r.$$.fragment,s),t=!1},d(s){s&&$(e),C(r)}}}function He(l){let e,r;return e=new fe({props:{$$slots:{main:[Fe],left:[Ae]},$$scope:{ctx:l}}}),{c(){v(e.$$.fragment)},m(t,s){L(e,t,s),r=!0},p(t,[s]){const o={};s&1&&(o.$$scope={dirty:s,ctx:t}),e.$set(o)},i(t){r||(b(e.$$.fragment,t),r=!0)},o(t){k(e.$$.fragment,t),r=!1},d(t){C(e,t)}}}function qe(l){return pe(async()=>{await de()}),[]}class Ue extends M{constructor(e){super(),P(this,e,qe,He,T,{})}}new Ue({target:document.getElementById("app")});
