import{S as M,i as D,s as P,c as Y,e as g,a as S,b as d,u as x,g as ee,d as te,t as y,f as b,h as $,L as F,j as q,k as H,l as K,m as v,n as k,o as C,p as Q,q as L,r as j,v as W,w as T,x as ne,y as E,z as h,A as J,B as I,C as Z,D as U,E as N,F as V,G as X,H as se,I as re,J as oe,K as le,M as ie,N as ae,O as fe,P as ue,Q as pe,R as ce,T as me}from"./MainLayers-271d044e.js";function de(l){let e,o;const t=l[1].default,s=Y(t,l,l[0],null);return{c(){e=g("div"),s&&s.c(),S(e,"class","svelte-eycl9h")},m(n,a){d(n,e,a),s&&s.m(e,null),o=!0},p(n,[a]){s&&s.p&&(!o||a&1)&&x(s,t,n,n[0],o?te(t,n[0],a,null):ee(n[0]),null)},i(n){o||(y(s,n),o=!0)},o(n){b(s,n),o=!1},d(n){n&&$(e),s&&s.d(n)}}}function $e(l,e,o){let{$$slots:t={},$$scope:s}=e;return l.$$set=n=>{"$$scope"in n&&o(0,s=n.$$scope)},[s,t]}class _e extends M{constructor(e){super(),D(this,e,$e,de,P,{})}}function ge(l){let e,o,t,s,n;e=new F({props:{source:"connected-roads",gj:l[0],layerStyle:l[2],show:l[1]}});function a(i){l[5](i)}let r={gj:l[0],name:"Roads connected to intersection",downloadable:!1};return l[1]!==void 0&&(r.show=l[1]),t=new q({props:r}),H.push(()=>K(t,"show",a)),{c(){v(e.$$.fragment),o=k(),v(t.$$.fragment)},m(i,f){C(e,i,f),d(i,o,f),C(t,i,f),n=!0},p(i,[f]){const p={};f&1&&(p.gj=i[0]),f&2&&(p.show=i[1]),e.$set(p);const c={};f&1&&(c.gj=i[0]),!s&&f&2&&(s=!0,c.show=i[1],Q(()=>s=!1)),t.$set(c)},i(i){n||(y(e.$$.fragment,i),y(t.$$.fragment,i),n=!0)},o(i){b(e.$$.fragment,i),b(t.$$.fragment,i),n=!1},d(i){i&&$(o),L(e,i),L(t,i)}}}function we(l,e,o){let t,s;j(l,W,f=>o(3,t=f)),j(l,T,f=>o(4,s=f));let n,a=!0,r={type:"fill",paint:{"fill-color":"blue","fill-opacity":.5}};function i(f){a=f,o(1,a)}return l.$$.update=()=>{l.$$.dirty&24&&(s&&t?o(0,n=JSON.parse(s.debugRoadsConnectedToIntersectionGeojson(t.properties.id))):o(0,n=void 0))},[n,a,r,t,s,i]}class he extends M{constructor(e){super(),D(this,e,we,ge,P,{})}}function ye(l){let e,o,t,s,n;e=new F({props:{source:"movements",gj:l[0],layerStyle:l[2],show:l[1]}});function a(i){l[5](i)}let r={gj:l[0],name:"Movement arrows",downloadable:!1};return l[1]!==void 0&&(r.show=l[1]),t=new q({props:r}),H.push(()=>K(t,"show",a)),{c(){v(e.$$.fragment),o=k(),v(t.$$.fragment)},m(i,f){C(e,i,f),d(i,o,f),C(t,i,f),n=!0},p(i,[f]){const p={};f&1&&(p.gj=i[0]),f&2&&(p.show=i[1]),e.$set(p);const c={};f&1&&(c.gj=i[0]),!s&&f&2&&(s=!0,c.show=i[1],Q(()=>s=!1)),t.$set(c)},i(i){n||(y(e.$$.fragment,i),y(t.$$.fragment,i),n=!0)},o(i){b(e.$$.fragment,i),b(t.$$.fragment,i),n=!1},d(i){i&&$(o),L(e,i),L(t,i)}}}function be(l,e,o){let t,s;j(l,T,f=>o(3,t=f)),j(l,ne,f=>o(4,s=f));let n,a=!0,r={type:"fill",paint:{"fill-color":"blue","fill-opacity":.5}};function i(f){a=f,o(1,a)}return l.$$.update=()=>{if(l.$$.dirty&24)if(t&&s){let f=s.properties;o(0,n=JSON.parse(t.debugMovementsFromLaneGeojson(f.road,f.index)))}else o(0,n=void 0)},[n,a,r,t,s,i]}class ve extends M{constructor(e){super(),D(this,e,be,ye,P,{})}}function ke(l){let e,o,t,s,n,a;return{c(){e=g("div"),o=g("label"),t=g("input"),s=E(`
    Clockwise ordering of roads`),S(t,"type","checkbox")},m(r,i){d(r,e,i),h(e,o),h(o,t),t.checked=l[0],h(o,s),n||(a=J(t,"change",l[5]),n=!0)},p(r,[i]){i&1&&(t.checked=r[0])},i:I,o:I,d(r){r&&$(e),n=!1,a()}}}function Ce(l,e,o){let t,s,n;j(l,Z,f=>o(2,t=f)),j(l,W,f=>o(3,s=f)),j(l,T,f=>o(4,n=f));let a=[],r=!1;function i(){r=this.checked,o(0,r)}return l.$$.update=()=>{if(l.$$.dirty&31){for(let f of a)f.remove();if(o(1,a=[]),r&&s){let f=JSON.parse(n.debugClockwiseOrderingForIntersectionGeojson(s.properties.id));for(let p of f.features)a.push(new U.Popup({closeButton:!1,closeOnClick:!1,focusAfterOpen:!1}).setLngLat(p.geometry.coordinates).setHTML(p.properties.label).addTo(t))}}},[r,a,t,s,n,i]}class Le extends M{constructor(e){super(),D(this,e,Ce,ke,P,{})}}function Se(l){let e,o,t,s,n,a;return e=new ve({}),t=new Le({}),n=new he({}),{c(){v(e.$$.fragment),o=k(),v(t.$$.fragment),s=k(),v(n.$$.fragment)},m(r,i){C(e,r,i),d(r,o,i),C(t,r,i),d(r,s,i),C(n,r,i),a=!0},p:I,i(r){a||(y(e.$$.fragment,r),y(t.$$.fragment,r),y(n.$$.fragment,r),a=!0)},o(r){b(e.$$.fragment,r),b(t.$$.fragment,r),b(n.$$.fragment,r),a=!1},d(r){r&&($(o),$(s)),L(e,r),L(t,r),L(n,r)}}}class je extends M{constructor(e){super(),D(this,e,null,Se,P,{})}}function A(l,e,o){const t=l.slice();return t[4]=e[o],t}function G(l){let e,o=l[4]+"",t,s,n;return{c(){e=g("a"),t=E(o),n=E(","),S(e,"href",s="https://www.openstreetmap.org/node/"+l[4]),S(e,"target","_blank")},m(a,r){d(a,e,r),h(e,t),d(a,n,r)},p(a,r){r&1&&o!==(o=a[4]+"")&&X(t,o),r&1&&s!==(s="https://www.openstreetmap.org/node/"+a[4])&&S(e,"href",s)},d(a){a&&($(e),$(n))}}}function Oe(l){let e,o,t,s,n,a,r,i,f,p=N(l[0].properties.osm_node_ids),c=[];for(let m=0;m<p.length;m+=1)c[m]=G(A(l,p,m));return{c(){e=g("pre"),e.textContent=`${JSON.stringify(l[1],null,"  ")}`,o=k(),t=g("div"),s=E(`OSM nodes:
  `);for(let m=0;m<c.length;m+=1)c[m].c();n=k(),a=g("div"),r=g("button"),r.textContent="Collapse intersection",S(r,"type","button")},m(m,_){d(m,e,_),d(m,o,_),d(m,t,_),h(t,s);for(let u=0;u<c.length;u+=1)c[u]&&c[u].m(t,null);d(m,n,_),d(m,a,_),h(a,r),i||(f=J(r,"click",l[2]),i=!0)},p(m,[_]){if(_&1){p=N(m[0].properties.osm_node_ids);let u;for(u=0;u<p.length;u+=1){const O=A(m,p,u);c[u]?c[u].p(O,_):(c[u]=G(O),c[u].c(),c[u].m(t,null))}for(;u<c.length;u+=1)c[u].d(1);c.length=p.length}},i:I,o:I,d(m){m&&($(e),$(o),$(t),$(n),$(a)),V(c,m),i=!1,f()}}}function Ie(l,e,o){let t;j(l,T,r=>o(3,t=r));let{intersection:s}=e,n=structuredClone(s.properties);delete n.osm_node_ids;function a(){t.collapseIntersection(s.properties.id),T.set(t)}return l.$$set=r=>{"intersection"in r&&o(0,s=r.intersection)},[s,n,a]}class Me extends M{constructor(e){super(),D(this,e,Ie,Oe,P,{intersection:0})}}function B(l,e,o){const t=l.slice();return t[5]=e[o],t}function z(l){let e,o=l[5]+"",t,s,n;return{c(){e=g("a"),t=E(o),n=E(","),S(e,"href",s="https://www.openstreetmap.org/way/"+l[5]),S(e,"target","_blank")},m(a,r){d(a,e,r),h(e,t),d(a,n,r)},p(a,r){r&1&&o!==(o=a[5]+"")&&X(t,o),r&1&&s!==(s="https://www.openstreetmap.org/way/"+a[5])&&S(e,"href",s)},d(a){a&&($(e),$(n))}}}function De(l){let e,o,t,s,n,a,r,i,f,p,c,m=N(l[0].properties.osm_way_ids),_=[];for(let u=0;u<m.length;u+=1)_[u]=z(B(l,m,u));return{c(){e=g("pre"),e.textContent=`${JSON.stringify(l[1],null,"  ")}`,o=k(),t=g("div"),s=E(`OSM ways:
  `);for(let u=0;u<_.length;u+=1)_[u].c();n=k(),a=g("div"),r=g("button"),r.textContent="Collapse short road",i=k(),f=g("button"),f.textContent="Zip side-path",S(r,"type","button"),S(f,"type","button")},m(u,O){d(u,e,O),d(u,o,O),d(u,t,O),h(t,s);for(let w=0;w<_.length;w+=1)_[w]&&_[w].m(t,null);d(u,n,O),d(u,a,O),h(a,r),h(a,i),h(a,f),p||(c=[J(r,"click",l[2]),J(f,"click",l[3])],p=!0)},p(u,[O]){if(O&1){m=N(u[0].properties.osm_way_ids);let w;for(w=0;w<m.length;w+=1){const R=B(u,m,w);_[w]?_[w].p(R,O):(_[w]=z(R),_[w].c(),_[w].m(t,null))}for(;w<_.length;w+=1)_[w].d(1);_.length=m.length}},i:I,o:I,d(u){u&&($(e),$(o),$(t),$(n),$(a)),V(_,u),p=!1,se(c)}}}function Pe(l,e,o){let t;j(l,T,i=>o(4,t=i));let{lane:s}=e,n=structuredClone(s.properties);delete n.osm_way_ids;function a(){t.collapseShortRoad(s.properties.road),T.set(t)}function r(){t.zipSidepath(s.properties.road),T.set(t)}return l.$$set=i=>{"lane"in i&&o(0,s=i.lane)},[s,n,a,r]}class Te extends M{constructor(e){super(),D(this,e,Pe,De,P,{lane:0})}}function Ee(l,e,o){let t,s,n;j(l,Z,r=>o(0,t=r)),j(l,oe,r=>o(1,s=r)),j(l,le,r=>o(2,n=r));let a=new U.Popup({closeButton:!1,closeOnClick:!1,maxWidth:"none"});return re(()=>{a.remove()}),l.$$.update=()=>{if(l.$$.dirty&7)if(n){let r=document.createElement("div");new Te({target:r,props:{lane:n}});let i=n.geometry.coordinates[0][0];a.setLngLat(i).setDOMContent(r).addTo(t)}else if(s){let r=document.createElement("div");new Me({target:r,props:{intersection:s}});let i=s.geometry.coordinates[0][0];a.setLngLat(i).setDOMContent(r).addTo(t)}else a.remove()},[t,s,n]}class Je extends M{constructor(e){super(),D(this,e,Ee,null,P,{})}}function Ne(l){let e,o,t,s,n,a,r,i,f;return s=new fe({}),i=new ue({}),{c(){e=g("div"),o=g("h1"),o.textContent="osm2streets Street Explorer",t=k(),v(s.$$.fragment),n=k(),a=g("hr"),r=k(),v(i.$$.fragment),S(e,"slot","left")},m(p,c){d(p,e,c),h(e,o),h(e,t),C(s,e,null),h(e,n),h(e,a),h(e,r),C(i,e,null),f=!0},p:I,i(p){f||(y(s.$$.fragment,p),y(i.$$.fragment,p),f=!0)},o(p){b(s.$$.fragment,p),b(i.$$.fragment,p),f=!1},d(p){p&&$(e),L(s),L(i)}}}function Re(l){let e,o,t,s,n,a;return e=new me({}),n=new je({}),{c(){v(e.$$.fragment),o=k(),t=g("hr"),s=k(),v(n.$$.fragment)},m(r,i){C(e,r,i),d(r,o,i),d(r,t,i),d(r,s,i),C(n,r,i),a=!0},p:I,i(r){a||(y(e.$$.fragment,r),y(n.$$.fragment,r),a=!0)},o(r){b(e.$$.fragment,r),b(n.$$.fragment,r),a=!1},d(r){r&&($(o),$(t),$(s)),L(e,r),L(n,r)}}}function Ae(l){let e,o,t,s;return e=new _e({props:{$$slots:{default:[Re]},$$scope:{ctx:l}}}),t=new Je({}),{c(){v(e.$$.fragment),o=k(),v(t.$$.fragment)},m(n,a){C(e,n,a),d(n,o,a),C(t,n,a),s=!0},p(n,a){const r={};a&1&&(r.$$scope={dirty:a,ctx:n}),e.$set(r)},i(n){s||(y(e.$$.fragment,n),y(t.$$.fragment,n),s=!0)},o(n){b(e.$$.fragment,n),b(t.$$.fragment,n),s=!1},d(n){n&&$(o),L(e,n),L(t,n)}}}function Ge(l){let e,o,t;return o=new pe({props:{$$slots:{default:[Ae]},$$scope:{ctx:l}}}),{c(){e=g("div"),v(o.$$.fragment),S(e,"slot","main")},m(s,n){d(s,e,n),C(o,e,null),t=!0},p(s,n){const a={};n&1&&(a.$$scope={dirty:n,ctx:s}),o.$set(a)},i(s){t||(y(o.$$.fragment,s),t=!0)},o(s){b(o.$$.fragment,s),t=!1},d(s){s&&$(e),L(o)}}}function Be(l){let e,o;return e=new ie({props:{$$slots:{main:[Ge],left:[Ne]},$$scope:{ctx:l}}}),{c(){v(e.$$.fragment)},m(t,s){C(e,t,s),o=!0},p(t,[s]){const n={};s&1&&(n.$$scope={dirty:s,ctx:t}),e.$set(n)},i(t){o||(y(e.$$.fragment,t),o=!0)},o(t){b(e.$$.fragment,t),o=!1},d(t){L(e,t)}}}function ze(l){return ae(async()=>{await ce()}),[]}class Fe extends M{constructor(e){super(),D(this,e,ze,Be,P,{})}}new Fe({target:document.getElementById("app")});
