import{S as M,i as P,s as T,c as Y,e as g,a as O,b as $,u as x,g as ee,d as te,t as b,f as k,h as _,L as F,j as H,k as q,l as U,m as v,n as y,o as L,p as K,q as C,r as S,v as Q,w as D,x as ne,y as E,z as w,A as J,B as I,C as V,D as W,E as N,F as Z,G as X,H as se,I as re,J as oe,K as le,M as ie,N as ae,O as pe,P as ue,Q as fe,R as ce,T as me,U as de,V as $e}from"./MainLayers-5dfe2449.js";function _e(l){let e,r;const t=l[1].default,s=Y(t,l,l[0],null);return{c(){e=g("div"),s&&s.c(),O(e,"class","svelte-eycl9h")},m(n,i){$(n,e,i),s&&s.m(e,null),r=!0},p(n,[i]){s&&s.p&&(!r||i&1)&&x(s,t,n,n[0],r?te(t,n[0],i,null):ee(n[0]),null)},i(n){r||(b(s,n),r=!0)},o(n){k(s,n),r=!1},d(n){n&&_(e),s&&s.d(n)}}}function ge(l,e,r){let{$$slots:t={},$$scope:s}=e;return l.$$set=n=>{"$$scope"in n&&r(0,s=n.$$scope)},[s,t]}class we extends M{constructor(e){super(),P(this,e,ge,_e,T,{})}}function he(l){let e,r,t,s,n;e=new F({props:{source:"connected-roads",gj:l[0],layerStyle:l[2],show:l[1]}});function i(a){l[5](a)}let o={gj:l[0],name:"Roads connected to intersection",downloadable:!1};return l[1]!==void 0&&(o.show=l[1]),t=new H({props:o}),q.push(()=>U(t,"show",i)),{c(){v(e.$$.fragment),r=y(),v(t.$$.fragment)},m(a,p){L(e,a,p),$(a,r,p),L(t,a,p),n=!0},p(a,[p]){const m={};p&1&&(m.gj=a[0]),p&2&&(m.show=a[1]),e.$set(m);const c={};p&1&&(c.gj=a[0]),!s&&p&2&&(s=!0,c.show=a[1],K(()=>s=!1)),t.$set(c)},i(a){n||(b(e.$$.fragment,a),b(t.$$.fragment,a),n=!0)},o(a){k(e.$$.fragment,a),k(t.$$.fragment,a),n=!1},d(a){a&&_(r),C(e,a),C(t,a)}}}function ye(l,e,r){let t,s;S(l,Q,p=>r(3,t=p)),S(l,D,p=>r(4,s=p));let n,i=!0,o={type:"fill",paint:{"fill-color":"blue","fill-opacity":.5}};function a(p){i=p,r(1,i)}return l.$$.update=()=>{l.$$.dirty&24&&(s&&t?r(0,n=JSON.parse(s.debugRoadsConnectedToIntersectionGeojson(t.properties.id))):r(0,n=void 0))},[n,i,o,t,s,a]}class be extends M{constructor(e){super(),P(this,e,ye,he,T,{})}}function ke(l){let e,r,t,s,n;e=new F({props:{source:"movements",gj:l[0],layerStyle:l[2],show:l[1]}});function i(a){l[5](a)}let o={gj:l[0],name:"Movement arrows",downloadable:!1};return l[1]!==void 0&&(o.show=l[1]),t=new H({props:o}),q.push(()=>U(t,"show",i)),{c(){v(e.$$.fragment),r=y(),v(t.$$.fragment)},m(a,p){L(e,a,p),$(a,r,p),L(t,a,p),n=!0},p(a,[p]){const m={};p&1&&(m.gj=a[0]),p&2&&(m.show=a[1]),e.$set(m);const c={};p&1&&(c.gj=a[0]),!s&&p&2&&(s=!0,c.show=a[1],K(()=>s=!1)),t.$set(c)},i(a){n||(b(e.$$.fragment,a),b(t.$$.fragment,a),n=!0)},o(a){k(e.$$.fragment,a),k(t.$$.fragment,a),n=!1},d(a){a&&_(r),C(e,a),C(t,a)}}}function ve(l,e,r){let t,s;S(l,D,p=>r(3,t=p)),S(l,ne,p=>r(4,s=p));let n,i=!0,o={type:"fill",paint:{"fill-color":"blue","fill-opacity":.5}};function a(p){i=p,r(1,i)}return l.$$.update=()=>{if(l.$$.dirty&24)if(t&&s){let p=s.properties;r(0,n=JSON.parse(t.debugMovementsFromLaneGeojson(p.road,p.index)))}else r(0,n=void 0)},[n,i,o,t,s,a]}class Le extends M{constructor(e){super(),P(this,e,ve,ke,T,{})}}function Ce(l){let e,r,t,s,n,i;return{c(){e=g("div"),r=g("label"),t=g("input"),s=E(`
    Clockwise ordering of roads`),O(t,"type","checkbox")},m(o,a){$(o,e,a),w(e,r),w(r,t),t.checked=l[0],w(r,s),n||(i=J(t,"change",l[5]),n=!0)},p(o,[a]){a&1&&(t.checked=o[0])},i:I,o:I,d(o){o&&_(e),n=!1,i()}}}function Se(l,e,r){let t,s,n;S(l,V,p=>r(2,t=p)),S(l,Q,p=>r(3,s=p)),S(l,D,p=>r(4,n=p));let i=[],o=!1;function a(){o=this.checked,r(0,o)}return l.$$.update=()=>{if(l.$$.dirty&31){for(let p of i)p.remove();if(r(1,i=[]),o&&s){let p=JSON.parse(n.debugClockwiseOrderingForIntersectionGeojson(s.properties.id));for(let m of p.features)i.push(new W.Popup({closeButton:!1,closeOnClick:!1,focusAfterOpen:!1}).setLngLat(m.geometry.coordinates).setHTML(m.properties.label).addTo(t))}}},[o,i,t,s,n,a]}class Oe extends M{constructor(e){super(),P(this,e,Se,Ce,T,{})}}function je(l){let e,r,t,s,n,i;return e=new Le({}),t=new Oe({}),n=new be({}),{c(){v(e.$$.fragment),r=y(),v(t.$$.fragment),s=y(),v(n.$$.fragment)},m(o,a){L(e,o,a),$(o,r,a),L(t,o,a),$(o,s,a),L(n,o,a),i=!0},p:I,i(o){i||(b(e.$$.fragment,o),b(t.$$.fragment,o),b(n.$$.fragment,o),i=!0)},o(o){k(e.$$.fragment,o),k(t.$$.fragment,o),k(n.$$.fragment,o),i=!1},d(o){o&&(_(r),_(s)),C(e,o),C(t,o),C(n,o)}}}class Ie extends M{constructor(e){super(),P(this,e,null,je,T,{})}}function A(l,e,r){const t=l.slice();return t[4]=e[r],t}function G(l){let e,r=l[4]+"",t,s,n;return{c(){e=g("a"),t=E(r),n=E(","),O(e,"href",s="https://www.openstreetmap.org/node/"+l[4]),O(e,"target","_blank")},m(i,o){$(i,e,o),w(e,t),$(i,n,o)},p(i,o){o&1&&r!==(r=i[4]+"")&&X(t,r),o&1&&s!==(s="https://www.openstreetmap.org/node/"+i[4])&&O(e,"href",s)},d(i){i&&(_(e),_(n))}}}function Me(l){let e,r,t,s,n,i,o,a,p,m=N(l[0].properties.osm_node_ids),c=[];for(let f=0;f<m.length;f+=1)c[f]=G(A(l,m,f));return{c(){e=g("pre"),e.textContent=`${JSON.stringify(l[1],null,"  ")}`,r=y(),t=g("div"),s=E(`OSM nodes:
  `);for(let f=0;f<c.length;f+=1)c[f].c();n=y(),i=g("div"),o=g("button"),o.textContent="Collapse intersection",O(o,"type","button")},m(f,d){$(f,e,d),$(f,r,d),$(f,t,d),w(t,s);for(let u=0;u<c.length;u+=1)c[u]&&c[u].m(t,null);$(f,n,d),$(f,i,d),w(i,o),a||(p=J(o,"click",l[2]),a=!0)},p(f,[d]){if(d&1){m=N(f[0].properties.osm_node_ids);let u;for(u=0;u<m.length;u+=1){const j=A(f,m,u);c[u]?c[u].p(j,d):(c[u]=G(j),c[u].c(),c[u].m(t,null))}for(;u<c.length;u+=1)c[u].d(1);c.length=m.length}},i:I,o:I,d(f){f&&(_(e),_(r),_(t),_(n),_(i)),Z(c,f),a=!1,p()}}}function Pe(l,e,r){let t;S(l,D,o=>r(3,t=o));let{intersection:s}=e,n=structuredClone(s.properties);delete n.osm_node_ids;function i(){t.collapseIntersection(s.properties.id),D.set(t)}return l.$$set=o=>{"intersection"in o&&r(0,s=o.intersection)},[s,n,i]}class Te extends M{constructor(e){super(),P(this,e,Pe,Me,T,{intersection:0})}}function B(l,e,r){const t=l.slice();return t[5]=e[r],t}function z(l){let e,r=l[5]+"",t,s,n;return{c(){e=g("a"),t=E(r),n=E(","),O(e,"href",s="https://www.openstreetmap.org/way/"+l[5]),O(e,"target","_blank")},m(i,o){$(i,e,o),w(e,t),$(i,n,o)},p(i,o){o&1&&r!==(r=i[5]+"")&&X(t,r),o&1&&s!==(s="https://www.openstreetmap.org/way/"+i[5])&&O(e,"href",s)},d(i){i&&(_(e),_(n))}}}function De(l){let e,r,t,s,n,i,o,a,p,m,c,f=N(l[0].properties.osm_way_ids),d=[];for(let u=0;u<f.length;u+=1)d[u]=z(B(l,f,u));return{c(){e=g("pre"),e.textContent=`${JSON.stringify(l[1],null,"  ")}`,r=y(),t=g("div"),s=E(`OSM ways:
  `);for(let u=0;u<d.length;u+=1)d[u].c();n=y(),i=g("div"),o=g("button"),o.textContent="Collapse short road",a=y(),p=g("button"),p.textContent="Zip side-path",O(o,"type","button"),O(p,"type","button")},m(u,j){$(u,e,j),$(u,r,j),$(u,t,j),w(t,s);for(let h=0;h<d.length;h+=1)d[h]&&d[h].m(t,null);$(u,n,j),$(u,i,j),w(i,o),w(i,a),w(i,p),m||(c=[J(o,"click",l[2]),J(p,"click",l[3])],m=!0)},p(u,[j]){if(j&1){f=N(u[0].properties.osm_way_ids);let h;for(h=0;h<f.length;h+=1){const R=B(u,f,h);d[h]?d[h].p(R,j):(d[h]=z(R),d[h].c(),d[h].m(t,null))}for(;h<d.length;h+=1)d[h].d(1);d.length=f.length}},i:I,o:I,d(u){u&&(_(e),_(r),_(t),_(n),_(i)),Z(d,u),m=!1,se(c)}}}function Ee(l,e,r){let t;S(l,D,a=>r(4,t=a));let{lane:s}=e,n=structuredClone(s.properties);delete n.osm_way_ids;function i(){t.collapseShortRoad(s.properties.road),D.set(t)}function o(){t.zipSidepath(s.properties.road),D.set(t)}return l.$$set=a=>{"lane"in a&&r(0,s=a.lane)},[s,n,i,o]}class Je extends M{constructor(e){super(),P(this,e,Ee,De,T,{lane:0})}}function Ne(l,e,r){let t,s,n,i,o;S(l,V,p=>r(0,t=p)),S(l,oe,p=>r(1,s=p)),S(l,le,p=>r(2,n=p)),S(l,ie,p=>r(3,i=p)),S(l,ae,p=>r(4,o=p));let a=new W.Popup({closeButton:!1,closeOnClick:!1,maxWidth:"none"});return re(()=>{a.remove()}),l.$$.update=()=>{if(l.$$.dirty&31)if(o){let p=document.createElement("div");new Je({target:p,props:{lane:o}}),a.setLngLat(i).setDOMContent(p).addTo(t)}else if(n){let p=document.createElement("div");new Te({target:p,props:{intersection:n}}),a.setLngLat(s).setDOMContent(p).addTo(t)}else a.remove()},[t,s,n,i,o]}class Re extends M{constructor(e){super(),P(this,e,Ne,null,T,{})}}function Ae(l){let e,r,t,s,n,i,o,a,p,m,c;return s=new fe({}),m=new ce({}),{c(){e=g("div"),r=g("h1"),r.textContent="osm2streets Street Explorer",t=y(),v(s.$$.fragment),n=y(),i=g("p"),i.innerHTML=`Understanding OSM streets &amp; intersections with
      <a href="https://github.com/a-b-street/osm2streets" target="_blank">osm2streets</a>.`,o=y(),a=g("hr"),p=y(),v(m.$$.fragment),O(e,"slot","left")},m(f,d){$(f,e,d),w(e,r),w(e,t),L(s,e,null),w(e,n),w(e,i),w(e,o),w(e,a),w(e,p),L(m,e,null),c=!0},p:I,i(f){c||(b(s.$$.fragment,f),b(m.$$.fragment,f),c=!0)},o(f){k(s.$$.fragment,f),k(m.$$.fragment,f),c=!1},d(f){f&&_(e),C(s),C(m)}}}function Ge(l){let e,r,t,s,n,i;return e=new $e({}),n=new Ie({}),{c(){v(e.$$.fragment),r=y(),t=g("hr"),s=y(),v(n.$$.fragment)},m(o,a){L(e,o,a),$(o,r,a),$(o,t,a),$(o,s,a),L(n,o,a),i=!0},p:I,i(o){i||(b(e.$$.fragment,o),b(n.$$.fragment,o),i=!0)},o(o){k(e.$$.fragment,o),k(n.$$.fragment,o),i=!1},d(o){o&&(_(r),_(t),_(s)),C(e,o),C(n,o)}}}function Be(l){let e,r,t,s;return e=new we({props:{$$slots:{default:[Ge]},$$scope:{ctx:l}}}),t=new Re({}),{c(){v(e.$$.fragment),r=y(),v(t.$$.fragment)},m(n,i){L(e,n,i),$(n,r,i),L(t,n,i),s=!0},p(n,i){const o={};i&1&&(o.$$scope={dirty:i,ctx:n}),e.$set(o)},i(n){s||(b(e.$$.fragment,n),b(t.$$.fragment,n),s=!0)},o(n){k(e.$$.fragment,n),k(t.$$.fragment,n),s=!1},d(n){n&&_(r),C(e,n),C(t,n)}}}function ze(l){let e,r,t;return r=new me({props:{$$slots:{default:[Be]},$$scope:{ctx:l}}}),{c(){e=g("div"),v(r.$$.fragment),O(e,"slot","main")},m(s,n){$(s,e,n),L(r,e,null),t=!0},p(s,n){const i={};n&1&&(i.$$scope={dirty:n,ctx:s}),r.$set(i)},i(s){t||(b(r.$$.fragment,s),t=!0)},o(s){k(r.$$.fragment,s),t=!1},d(s){s&&_(e),C(r)}}}function Fe(l){let e,r;return e=new pe({props:{$$slots:{main:[ze],left:[Ae]},$$scope:{ctx:l}}}),{c(){v(e.$$.fragment)},m(t,s){L(e,t,s),r=!0},p(t,[s]){const n={};s&1&&(n.$$scope={dirty:s,ctx:t}),e.$set(n)},i(t){r||(b(e.$$.fragment,t),r=!0)},o(t){k(e.$$.fragment,t),r=!1},d(t){C(e,t)}}}function He(l){return ue(async()=>{await de()}),[]}class qe extends M{constructor(e){super(),P(this,e,He,Fe,T,{})}}new qe({target:document.getElementById("app")});
