import{S as M,i as P,s as D,c as Y,e as g,a as j,b as d,u as x,g as ee,d as te,t as y,f as b,h as $,L as F,j as q,k as H,l as K,m as k,n as v,o as C,p as Q,q as L,r as S,v as U,w as T,x as ne,y as E,z as h,A as J,B as O,C as V,D as W,E as N,F as Z,G as X,H as se,I as oe,J as re,K as le,M as ie,N as ae,O as ue,P as fe,Q as pe,R as ce,T as me,U as de,V as $e}from"./MainLayers-2b910e36.js";function _e(l){let e,o;const t=l[1].default,s=Y(t,l,l[0],null);return{c(){e=g("div"),s&&s.c(),j(e,"class","svelte-eycl9h")},m(n,a){d(n,e,a),s&&s.m(e,null),o=!0},p(n,[a]){s&&s.p&&(!o||a&1)&&x(s,t,n,n[0],o?te(t,n[0],a,null):ee(n[0]),null)},i(n){o||(y(s,n),o=!0)},o(n){b(s,n),o=!1},d(n){n&&$(e),s&&s.d(n)}}}function ge(l,e,o){let{$$slots:t={},$$scope:s}=e;return l.$$set=n=>{"$$scope"in n&&o(0,s=n.$$scope)},[s,t]}class we extends M{constructor(e){super(),P(this,e,ge,_e,D,{})}}function he(l){let e,o,t,s,n;e=new F({props:{source:"connected-roads",gj:l[0],layerStyle:l[2],show:l[1]}});function a(i){l[5](i)}let r={gj:l[0],name:"Roads connected to intersection",downloadable:!1};return l[1]!==void 0&&(r.show=l[1]),t=new q({props:r}),H.push(()=>K(t,"show",a)),{c(){k(e.$$.fragment),o=v(),k(t.$$.fragment)},m(i,u){C(e,i,u),d(i,o,u),C(t,i,u),n=!0},p(i,[u]){const p={};u&1&&(p.gj=i[0]),u&2&&(p.show=i[1]),e.$set(p);const c={};u&1&&(c.gj=i[0]),!s&&u&2&&(s=!0,c.show=i[1],Q(()=>s=!1)),t.$set(c)},i(i){n||(y(e.$$.fragment,i),y(t.$$.fragment,i),n=!0)},o(i){b(e.$$.fragment,i),b(t.$$.fragment,i),n=!1},d(i){i&&$(o),L(e,i),L(t,i)}}}function ye(l,e,o){let t,s;S(l,U,u=>o(3,t=u)),S(l,T,u=>o(4,s=u));let n,a=!0,r={type:"fill",paint:{"fill-color":"blue","fill-opacity":.5}};function i(u){a=u,o(1,a)}return l.$$.update=()=>{l.$$.dirty&24&&(s&&t?o(0,n=JSON.parse(s.debugRoadsConnectedToIntersectionGeojson(t.properties.id))):o(0,n=void 0))},[n,a,r,t,s,i]}class be extends M{constructor(e){super(),P(this,e,ye,he,D,{})}}function ke(l){let e,o,t,s,n;e=new F({props:{source:"movements",gj:l[0],layerStyle:l[2],show:l[1]}});function a(i){l[5](i)}let r={gj:l[0],name:"Movement arrows",downloadable:!1};return l[1]!==void 0&&(r.show=l[1]),t=new q({props:r}),H.push(()=>K(t,"show",a)),{c(){k(e.$$.fragment),o=v(),k(t.$$.fragment)},m(i,u){C(e,i,u),d(i,o,u),C(t,i,u),n=!0},p(i,[u]){const p={};u&1&&(p.gj=i[0]),u&2&&(p.show=i[1]),e.$set(p);const c={};u&1&&(c.gj=i[0]),!s&&u&2&&(s=!0,c.show=i[1],Q(()=>s=!1)),t.$set(c)},i(i){n||(y(e.$$.fragment,i),y(t.$$.fragment,i),n=!0)},o(i){b(e.$$.fragment,i),b(t.$$.fragment,i),n=!1},d(i){i&&$(o),L(e,i),L(t,i)}}}function ve(l,e,o){let t,s;S(l,T,u=>o(3,t=u)),S(l,ne,u=>o(4,s=u));let n,a=!0,r={type:"fill",paint:{"fill-color":"blue","fill-opacity":.5}};function i(u){a=u,o(1,a)}return l.$$.update=()=>{if(l.$$.dirty&24)if(t&&s){let u=s.properties;o(0,n=JSON.parse(t.debugMovementsFromLaneGeojson(u.road,u.index)))}else o(0,n=void 0)},[n,a,r,t,s,i]}class Ce extends M{constructor(e){super(),P(this,e,ve,ke,D,{})}}function Le(l){let e,o,t,s,n,a;return{c(){e=g("div"),o=g("label"),t=g("input"),s=E(`
    Clockwise ordering of roads`),j(t,"type","checkbox")},m(r,i){d(r,e,i),h(e,o),h(o,t),t.checked=l[0],h(o,s),n||(a=J(t,"change",l[5]),n=!0)},p(r,[i]){i&1&&(t.checked=r[0])},i:O,o:O,d(r){r&&$(e),n=!1,a()}}}function Se(l,e,o){let t,s,n;S(l,V,u=>o(2,t=u)),S(l,U,u=>o(3,s=u)),S(l,T,u=>o(4,n=u));let a=[],r=!1;function i(){r=this.checked,o(0,r)}return l.$$.update=()=>{if(l.$$.dirty&31){for(let u of a)u.remove();if(o(1,a=[]),r&&s){let u=JSON.parse(n.debugClockwiseOrderingForIntersectionGeojson(s.properties.id));for(let p of u.features)a.push(new W.Popup({closeButton:!1,closeOnClick:!1,focusAfterOpen:!1}).setLngLat(p.geometry.coordinates).setHTML(p.properties.label).addTo(t))}}},[r,a,t,s,n,i]}class je extends M{constructor(e){super(),P(this,e,Se,Le,D,{})}}function Ie(l){let e,o,t,s,n,a;return e=new Ce({}),t=new je({}),n=new be({}),{c(){k(e.$$.fragment),o=v(),k(t.$$.fragment),s=v(),k(n.$$.fragment)},m(r,i){C(e,r,i),d(r,o,i),C(t,r,i),d(r,s,i),C(n,r,i),a=!0},p:O,i(r){a||(y(e.$$.fragment,r),y(t.$$.fragment,r),y(n.$$.fragment,r),a=!0)},o(r){b(e.$$.fragment,r),b(t.$$.fragment,r),b(n.$$.fragment,r),a=!1},d(r){r&&($(o),$(s)),L(e,r),L(t,r),L(n,r)}}}class Oe extends M{constructor(e){super(),P(this,e,null,Ie,D,{})}}function A(l,e,o){const t=l.slice();return t[4]=e[o],t}function G(l){let e,o=l[4]+"",t,s,n;return{c(){e=g("a"),t=E(o),n=E(","),j(e,"href",s="https://www.openstreetmap.org/node/"+l[4]),j(e,"target","_blank")},m(a,r){d(a,e,r),h(e,t),d(a,n,r)},p(a,r){r&1&&o!==(o=a[4]+"")&&X(t,o),r&1&&s!==(s="https://www.openstreetmap.org/node/"+a[4])&&j(e,"href",s)},d(a){a&&($(e),$(n))}}}function Me(l){let e,o,t,s,n,a,r,i,u,p=N(l[0].properties.osm_node_ids),c=[];for(let m=0;m<p.length;m+=1)c[m]=G(A(l,p,m));return{c(){e=g("pre"),e.textContent=`${JSON.stringify(l[1],null,"  ")}`,o=v(),t=g("div"),s=E(`OSM nodes:
  `);for(let m=0;m<c.length;m+=1)c[m].c();n=v(),a=g("div"),r=g("button"),r.textContent="Collapse intersection",j(r,"type","button")},m(m,_){d(m,e,_),d(m,o,_),d(m,t,_),h(t,s);for(let f=0;f<c.length;f+=1)c[f]&&c[f].m(t,null);d(m,n,_),d(m,a,_),h(a,r),i||(u=J(r,"click",l[2]),i=!0)},p(m,[_]){if(_&1){p=N(m[0].properties.osm_node_ids);let f;for(f=0;f<p.length;f+=1){const I=A(m,p,f);c[f]?c[f].p(I,_):(c[f]=G(I),c[f].c(),c[f].m(t,null))}for(;f<c.length;f+=1)c[f].d(1);c.length=p.length}},i:O,o:O,d(m){m&&($(e),$(o),$(t),$(n),$(a)),Z(c,m),i=!1,u()}}}function Pe(l,e,o){let t;S(l,T,r=>o(3,t=r));let{intersection:s}=e,n=structuredClone(s.properties);delete n.osm_node_ids;function a(){t.collapseIntersection(s.properties.id),T.set(t)}return l.$$set=r=>{"intersection"in r&&o(0,s=r.intersection)},[s,n,a]}class De extends M{constructor(e){super(),P(this,e,Pe,Me,D,{intersection:0})}}function B(l,e,o){const t=l.slice();return t[5]=e[o],t}function z(l){let e,o=l[5]+"",t,s,n;return{c(){e=g("a"),t=E(o),n=E(","),j(e,"href",s="https://www.openstreetmap.org/way/"+l[5]),j(e,"target","_blank")},m(a,r){d(a,e,r),h(e,t),d(a,n,r)},p(a,r){r&1&&o!==(o=a[5]+"")&&X(t,o),r&1&&s!==(s="https://www.openstreetmap.org/way/"+a[5])&&j(e,"href",s)},d(a){a&&($(e),$(n))}}}function Te(l){let e,o,t,s,n,a,r,i,u,p,c,m=N(l[0].properties.osm_way_ids),_=[];for(let f=0;f<m.length;f+=1)_[f]=z(B(l,m,f));return{c(){e=g("pre"),e.textContent=`${JSON.stringify(l[1],null,"  ")}`,o=v(),t=g("div"),s=E(`OSM ways:
  `);for(let f=0;f<_.length;f+=1)_[f].c();n=v(),a=g("div"),r=g("button"),r.textContent="Collapse short road",i=v(),u=g("button"),u.textContent="Zip side-path",j(r,"type","button"),j(u,"type","button")},m(f,I){d(f,e,I),d(f,o,I),d(f,t,I),h(t,s);for(let w=0;w<_.length;w+=1)_[w]&&_[w].m(t,null);d(f,n,I),d(f,a,I),h(a,r),h(a,i),h(a,u),p||(c=[J(r,"click",l[2]),J(u,"click",l[3])],p=!0)},p(f,[I]){if(I&1){m=N(f[0].properties.osm_way_ids);let w;for(w=0;w<m.length;w+=1){const R=B(f,m,w);_[w]?_[w].p(R,I):(_[w]=z(R),_[w].c(),_[w].m(t,null))}for(;w<_.length;w+=1)_[w].d(1);_.length=m.length}},i:O,o:O,d(f){f&&($(e),$(o),$(t),$(n),$(a)),Z(_,f),p=!1,se(c)}}}function Ee(l,e,o){let t;S(l,T,i=>o(4,t=i));let{lane:s}=e,n=structuredClone(s.properties);delete n.osm_way_ids;function a(){t.collapseShortRoad(s.properties.road),T.set(t)}function r(){t.zipSidepath(s.properties.road),T.set(t)}return l.$$set=i=>{"lane"in i&&o(0,s=i.lane)},[s,n,a,r]}class Je extends M{constructor(e){super(),P(this,e,Ee,Te,D,{lane:0})}}function Ne(l,e,o){let t,s,n,a,r;S(l,V,u=>o(0,t=u)),S(l,re,u=>o(1,s=u)),S(l,le,u=>o(2,n=u)),S(l,ie,u=>o(3,a=u)),S(l,ae,u=>o(4,r=u));let i=new W.Popup({closeButton:!1,closeOnClick:!1,maxWidth:"none"});return oe(()=>{i.remove()}),l.$$.update=()=>{if(l.$$.dirty&31)if(r){let u=document.createElement("div");new Je({target:u,props:{lane:r}}),i.setLngLat(a).setDOMContent(u).addTo(t)}else if(n){let u=document.createElement("div");new De({target:u,props:{intersection:n}}),i.setLngLat(s).setDOMContent(u).addTo(t)}else i.remove()},[t,s,n,a,r]}class Re extends M{constructor(e){super(),P(this,e,Ne,null,D,{})}}function Ae(l){let e,o,t,s,n,a,r,i,u;return s=new pe({}),i=new ce({}),{c(){e=g("div"),o=g("h1"),o.textContent="osm2streets Street Explorer",t=v(),k(s.$$.fragment),n=v(),a=g("hr"),r=v(),k(i.$$.fragment),j(e,"slot","left")},m(p,c){d(p,e,c),h(e,o),h(e,t),C(s,e,null),h(e,n),h(e,a),h(e,r),C(i,e,null),u=!0},p:O,i(p){u||(y(s.$$.fragment,p),y(i.$$.fragment,p),u=!0)},o(p){b(s.$$.fragment,p),b(i.$$.fragment,p),u=!1},d(p){p&&$(e),L(s),L(i)}}}function Ge(l){let e,o,t,s,n,a;return e=new $e({}),n=new Oe({}),{c(){k(e.$$.fragment),o=v(),t=g("hr"),s=v(),k(n.$$.fragment)},m(r,i){C(e,r,i),d(r,o,i),d(r,t,i),d(r,s,i),C(n,r,i),a=!0},p:O,i(r){a||(y(e.$$.fragment,r),y(n.$$.fragment,r),a=!0)},o(r){b(e.$$.fragment,r),b(n.$$.fragment,r),a=!1},d(r){r&&($(o),$(t),$(s)),L(e,r),L(n,r)}}}function Be(l){let e,o,t,s;return e=new we({props:{$$slots:{default:[Ge]},$$scope:{ctx:l}}}),t=new Re({}),{c(){k(e.$$.fragment),o=v(),k(t.$$.fragment)},m(n,a){C(e,n,a),d(n,o,a),C(t,n,a),s=!0},p(n,a){const r={};a&1&&(r.$$scope={dirty:a,ctx:n}),e.$set(r)},i(n){s||(y(e.$$.fragment,n),y(t.$$.fragment,n),s=!0)},o(n){b(e.$$.fragment,n),b(t.$$.fragment,n),s=!1},d(n){n&&$(o),L(e,n),L(t,n)}}}function ze(l){let e,o,t;return o=new me({props:{$$slots:{default:[Be]},$$scope:{ctx:l}}}),{c(){e=g("div"),k(o.$$.fragment),j(e,"slot","main")},m(s,n){d(s,e,n),C(o,e,null),t=!0},p(s,n){const a={};n&1&&(a.$$scope={dirty:n,ctx:s}),o.$set(a)},i(s){t||(y(o.$$.fragment,s),t=!0)},o(s){b(o.$$.fragment,s),t=!1},d(s){s&&$(e),L(o)}}}function Fe(l){let e,o;return e=new ue({props:{$$slots:{main:[ze],left:[Ae]},$$scope:{ctx:l}}}),{c(){k(e.$$.fragment)},m(t,s){C(e,t,s),o=!0},p(t,[s]){const n={};s&1&&(n.$$scope={dirty:s,ctx:t}),e.$set(n)},i(t){o||(y(e.$$.fragment,t),o=!0)},o(t){b(e.$$.fragment,t),o=!1},d(t){L(e,t)}}}function qe(l){return fe(async()=>{await de()}),[]}class He extends M{constructor(e){super(),P(this,e,qe,Fe,D,{})}}new He({target:document.getElementById("app")});
