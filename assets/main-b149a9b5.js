import{S as M,i as P,s as T,L as F,a as q,b as H,c as K,d as v,e as k,m as C,f as d,g as Q,t as y,h as b,j as $,k as L,l as j,n as W,o as D,p as Y,q as g,r as E,u as S,v as h,w as J,x as I,y as Z,z as U,A as x,B as ee,C as te,D as ne,E as N,F as V,G as X,H as se,I as re,J as oe,K as le,M as ae,N as ie,O as fe,P as ue,Q as pe,R as ce,T as me}from"./Map-4025d0a0.js";function de(l){let e,o,t,s,n;e=new F({props:{source:"connected-roads",gj:l[0],layerStyle:l[2],show:l[1]}});function i(a){l[5](a)}let r={gj:l[0],name:"Roads connected to intersection",downloadable:!1};return l[1]!==void 0&&(r.show=l[1]),t=new q({props:r}),H.push(()=>K(t,"show",i)),{c(){v(e.$$.fragment),o=k(),v(t.$$.fragment)},m(a,f){C(e,a,f),d(a,o,f),C(t,a,f),n=!0},p(a,[f]){const p={};f&1&&(p.gj=a[0]),f&2&&(p.show=a[1]),e.$set(p);const c={};f&1&&(c.gj=a[0]),!s&&f&2&&(s=!0,c.show=a[1],Q(()=>s=!1)),t.$set(c)},i(a){n||(y(e.$$.fragment,a),y(t.$$.fragment,a),n=!0)},o(a){b(e.$$.fragment,a),b(t.$$.fragment,a),n=!1},d(a){a&&$(o),L(e,a),L(t,a)}}}function $e(l,e,o){let t,s;j(l,W,f=>o(3,t=f)),j(l,D,f=>o(4,s=f));let n,i=!0,r={type:"fill",paint:{"fill-color":"blue","fill-opacity":.5}};function a(f){i=f,o(1,i)}return l.$$.update=()=>{l.$$.dirty&24&&(s&&t?o(0,n=JSON.parse(s.debugRoadsConnectedToIntersectionGeojson(t.properties.id))):o(0,n=void 0))},[n,i,r,t,s,a]}class _e extends M{constructor(e){super(),P(this,e,$e,de,T,{})}}function ge(l){let e,o,t,s,n;e=new F({props:{source:"movements",gj:l[0],layerStyle:l[2],show:l[1]}});function i(a){l[5](a)}let r={gj:l[0],name:"Movement arrows",downloadable:!1};return l[1]!==void 0&&(r.show=l[1]),t=new q({props:r}),H.push(()=>K(t,"show",i)),{c(){v(e.$$.fragment),o=k(),v(t.$$.fragment)},m(a,f){C(e,a,f),d(a,o,f),C(t,a,f),n=!0},p(a,[f]){const p={};f&1&&(p.gj=a[0]),f&2&&(p.show=a[1]),e.$set(p);const c={};f&1&&(c.gj=a[0]),!s&&f&2&&(s=!0,c.show=a[1],Q(()=>s=!1)),t.$set(c)},i(a){n||(y(e.$$.fragment,a),y(t.$$.fragment,a),n=!0)},o(a){b(e.$$.fragment,a),b(t.$$.fragment,a),n=!1},d(a){a&&$(o),L(e,a),L(t,a)}}}function we(l,e,o){let t,s;j(l,D,f=>o(3,t=f)),j(l,Y,f=>o(4,s=f));let n,i=!0,r={type:"fill",paint:{"fill-color":"blue","fill-opacity":.5}};function a(f){i=f,o(1,i)}return l.$$.update=()=>{if(l.$$.dirty&24)if(t&&s){let f=s.properties;o(0,n=JSON.parse(t.debugMovementsFromLaneGeojson(f.road,f.index)))}else o(0,n=void 0)},[n,i,r,t,s,a]}class he extends M{constructor(e){super(),P(this,e,we,ge,T,{})}}function ye(l){let e,o,t,s,n,i;return{c(){e=g("div"),o=g("label"),t=g("input"),s=E(`
    Clockwise ordering of roads`),S(t,"type","checkbox")},m(r,a){d(r,e,a),h(e,o),h(o,t),t.checked=l[0],h(o,s),n||(i=J(t,"change",l[5]),n=!0)},p(r,[a]){a&1&&(t.checked=r[0])},i:I,o:I,d(r){r&&$(e),n=!1,i()}}}function be(l,e,o){let t,s,n;j(l,Z,f=>o(2,t=f)),j(l,W,f=>o(3,s=f)),j(l,D,f=>o(4,n=f));let i=[],r=!1;function a(){r=this.checked,o(0,r)}return l.$$.update=()=>{if(l.$$.dirty&31){for(let f of i)f.remove();if(o(1,i=[]),r&&s){let f=JSON.parse(n.debugClockwiseOrderingForIntersectionGeojson(s.properties.id));for(let p of f.features)i.push(new U.Popup({closeButton:!1,closeOnClick:!1,focusAfterOpen:!1}).setLngLat(p.geometry.coordinates).setHTML(p.properties.label).addTo(t))}}},[r,i,t,s,n,a]}class ve extends M{constructor(e){super(),P(this,e,be,ye,T,{})}}function ke(l){let e,o,t,s,n,i;return e=new he({}),t=new ve({}),n=new _e({}),{c(){v(e.$$.fragment),o=k(),v(t.$$.fragment),s=k(),v(n.$$.fragment)},m(r,a){C(e,r,a),d(r,o,a),C(t,r,a),d(r,s,a),C(n,r,a),i=!0},p:I,i(r){i||(y(e.$$.fragment,r),y(t.$$.fragment,r),y(n.$$.fragment,r),i=!0)},o(r){b(e.$$.fragment,r),b(t.$$.fragment,r),b(n.$$.fragment,r),i=!1},d(r){r&&($(o),$(s)),L(e,r),L(t,r),L(n,r)}}}class Ce extends M{constructor(e){super(),P(this,e,null,ke,T,{})}}function Le(l){let e,o;const t=l[1].default,s=x(t,l,l[0],null);return{c(){e=g("div"),s&&s.c(),S(e,"class","svelte-eycl9h")},m(n,i){d(n,e,i),s&&s.m(e,null),o=!0},p(n,[i]){s&&s.p&&(!o||i&1)&&ee(s,t,n,n[0],o?ne(t,n[0],i,null):te(n[0]),null)},i(n){o||(y(s,n),o=!0)},o(n){b(s,n),o=!1},d(n){n&&$(e),s&&s.d(n)}}}function Se(l,e,o){let{$$slots:t={},$$scope:s}=e;return l.$$set=n=>{"$$scope"in n&&o(0,s=n.$$scope)},[s,t]}class je extends M{constructor(e){super(),P(this,e,Se,Le,T,{})}}function A(l,e,o){const t=l.slice();return t[4]=e[o],t}function G(l){let e,o=l[4]+"",t,s,n;return{c(){e=g("a"),t=E(o),n=E(","),S(e,"href",s="https://www.openstreetmap.org/node/"+l[4]),S(e,"target","_blank")},m(i,r){d(i,e,r),h(e,t),d(i,n,r)},p(i,r){r&1&&o!==(o=i[4]+"")&&X(t,o),r&1&&s!==(s="https://www.openstreetmap.org/node/"+i[4])&&S(e,"href",s)},d(i){i&&($(e),$(n))}}}function Oe(l){let e,o,t,s,n,i,r,a,f,p=N(l[0].properties.osm_node_ids),c=[];for(let m=0;m<p.length;m+=1)c[m]=G(A(l,p,m));return{c(){e=g("pre"),e.textContent=`${JSON.stringify(l[1],null,"  ")}`,o=k(),t=g("div"),s=E(`OSM nodes:
  `);for(let m=0;m<c.length;m+=1)c[m].c();n=k(),i=g("div"),r=g("button"),r.textContent="Collapse intersection",S(r,"type","button")},m(m,_){d(m,e,_),d(m,o,_),d(m,t,_),h(t,s);for(let u=0;u<c.length;u+=1)c[u]&&c[u].m(t,null);d(m,n,_),d(m,i,_),h(i,r),a||(f=J(r,"click",l[2]),a=!0)},p(m,[_]){if(_&1){p=N(m[0].properties.osm_node_ids);let u;for(u=0;u<p.length;u+=1){const O=A(m,p,u);c[u]?c[u].p(O,_):(c[u]=G(O),c[u].c(),c[u].m(t,null))}for(;u<c.length;u+=1)c[u].d(1);c.length=p.length}},i:I,o:I,d(m){m&&($(e),$(o),$(t),$(n),$(i)),V(c,m),a=!1,f()}}}function Ie(l,e,o){let t;j(l,D,r=>o(3,t=r));let{intersection:s}=e,n=structuredClone(s.properties);delete n.osm_node_ids;function i(){t.collapseIntersection(s.properties.id),D.set(t)}return l.$$set=r=>{"intersection"in r&&o(0,s=r.intersection)},[s,n,i]}class Me extends M{constructor(e){super(),P(this,e,Ie,Oe,T,{intersection:0})}}function B(l,e,o){const t=l.slice();return t[5]=e[o],t}function z(l){let e,o=l[5]+"",t,s,n;return{c(){e=g("a"),t=E(o),n=E(","),S(e,"href",s="https://www.openstreetmap.org/way/"+l[5]),S(e,"target","_blank")},m(i,r){d(i,e,r),h(e,t),d(i,n,r)},p(i,r){r&1&&o!==(o=i[5]+"")&&X(t,o),r&1&&s!==(s="https://www.openstreetmap.org/way/"+i[5])&&S(e,"href",s)},d(i){i&&($(e),$(n))}}}function Pe(l){let e,o,t,s,n,i,r,a,f,p,c,m=N(l[0].properties.osm_way_ids),_=[];for(let u=0;u<m.length;u+=1)_[u]=z(B(l,m,u));return{c(){e=g("pre"),e.textContent=`${JSON.stringify(l[1],null,"  ")}`,o=k(),t=g("div"),s=E(`OSM ways:
  `);for(let u=0;u<_.length;u+=1)_[u].c();n=k(),i=g("div"),r=g("button"),r.textContent="Collapse short road",a=k(),f=g("button"),f.textContent="Zip side-path",S(r,"type","button"),S(f,"type","button")},m(u,O){d(u,e,O),d(u,o,O),d(u,t,O),h(t,s);for(let w=0;w<_.length;w+=1)_[w]&&_[w].m(t,null);d(u,n,O),d(u,i,O),h(i,r),h(i,a),h(i,f),p||(c=[J(r,"click",l[2]),J(f,"click",l[3])],p=!0)},p(u,[O]){if(O&1){m=N(u[0].properties.osm_way_ids);let w;for(w=0;w<m.length;w+=1){const R=B(u,m,w);_[w]?_[w].p(R,O):(_[w]=z(R),_[w].c(),_[w].m(t,null))}for(;w<_.length;w+=1)_[w].d(1);_.length=m.length}},i:I,o:I,d(u){u&&($(e),$(o),$(t),$(n),$(i)),V(_,u),p=!1,se(c)}}}function Te(l,e,o){let t;j(l,D,a=>o(4,t=a));let{lane:s}=e,n=structuredClone(s.properties);delete n.osm_way_ids;function i(){t.collapseShortRoad(s.properties.road),D.set(t)}function r(){t.zipSidepath(s.properties.road),D.set(t)}return l.$$set=a=>{"lane"in a&&o(0,s=a.lane)},[s,n,i,r]}class De extends M{constructor(e){super(),P(this,e,Te,Pe,T,{lane:0})}}function Ee(l,e,o){let t,s,n;j(l,Z,r=>o(0,t=r)),j(l,oe,r=>o(1,s=r)),j(l,le,r=>o(2,n=r));let i=new U.Popup({closeButton:!1,closeOnClick:!1,maxWidth:"none"});return re(()=>{i.remove()}),l.$$.update=()=>{if(l.$$.dirty&7)if(n){let r=document.createElement("div");new De({target:r,props:{lane:n}});let a=n.geometry.coordinates[0][0];i.setLngLat(a).setDOMContent(r).addTo(t)}else if(s){let r=document.createElement("div");new Me({target:r,props:{intersection:s}});let a=s.geometry.coordinates[0][0];i.setLngLat(a).setDOMContent(r).addTo(t)}else i.remove()},[t,s,n]}class Je extends M{constructor(e){super(),P(this,e,Ee,null,T,{})}}function Ne(l){let e,o,t,s,n,i,r,a,f;return s=new fe({}),a=new ue({}),{c(){e=g("div"),o=g("h1"),o.textContent="osm2streets Street Explorer",t=k(),v(s.$$.fragment),n=k(),i=g("hr"),r=k(),v(a.$$.fragment),S(e,"slot","left")},m(p,c){d(p,e,c),h(e,o),h(e,t),C(s,e,null),h(e,n),h(e,i),h(e,r),C(a,e,null),f=!0},p:I,i(p){f||(y(s.$$.fragment,p),y(a.$$.fragment,p),f=!0)},o(p){b(s.$$.fragment,p),b(a.$$.fragment,p),f=!1},d(p){p&&$(e),L(s),L(a)}}}function Re(l){let e,o,t,s,n,i;return e=new me({}),n=new Ce({}),{c(){v(e.$$.fragment),o=k(),t=g("hr"),s=k(),v(n.$$.fragment)},m(r,a){C(e,r,a),d(r,o,a),d(r,t,a),d(r,s,a),C(n,r,a),i=!0},p:I,i(r){i||(y(e.$$.fragment,r),y(n.$$.fragment,r),i=!0)},o(r){b(e.$$.fragment,r),b(n.$$.fragment,r),i=!1},d(r){r&&($(o),$(t),$(s)),L(e,r),L(n,r)}}}function Ae(l){let e,o,t,s;return e=new je({props:{$$slots:{default:[Re]},$$scope:{ctx:l}}}),t=new Je({}),{c(){v(e.$$.fragment),o=k(),v(t.$$.fragment)},m(n,i){C(e,n,i),d(n,o,i),C(t,n,i),s=!0},p(n,i){const r={};i&1&&(r.$$scope={dirty:i,ctx:n}),e.$set(r)},i(n){s||(y(e.$$.fragment,n),y(t.$$.fragment,n),s=!0)},o(n){b(e.$$.fragment,n),b(t.$$.fragment,n),s=!1},d(n){n&&$(o),L(e,n),L(t,n)}}}function Ge(l){let e,o,t;return o=new pe({props:{$$slots:{default:[Ae]},$$scope:{ctx:l}}}),{c(){e=g("div"),v(o.$$.fragment),S(e,"slot","main")},m(s,n){d(s,e,n),C(o,e,null),t=!0},p(s,n){const i={};n&1&&(i.$$scope={dirty:n,ctx:s}),o.$set(i)},i(s){t||(y(o.$$.fragment,s),t=!0)},o(s){b(o.$$.fragment,s),t=!1},d(s){s&&$(e),L(o)}}}function Be(l){let e,o;return e=new ae({props:{$$slots:{main:[Ge],left:[Ne]},$$scope:{ctx:l}}}),{c(){v(e.$$.fragment)},m(t,s){C(e,t,s),o=!0},p(t,[s]){const n={};s&1&&(n.$$scope={dirty:s,ctx:t}),e.$set(n)},i(t){o||(y(e.$$.fragment,t),o=!0)},o(t){b(e.$$.fragment,t),o=!1},d(t){L(e,t)}}}function ze(l){return ie(async()=>{await ce()}),[]}class Fe extends M{constructor(e){super(),P(this,e,ze,Be,T,{})}}new Fe({target:document.getElementById("app")});
